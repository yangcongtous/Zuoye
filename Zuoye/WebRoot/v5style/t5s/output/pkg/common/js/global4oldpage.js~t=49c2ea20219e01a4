ZDK.define("module.passport",function(a,b){function c(){this.$topBarCtn=$("#J-header-logic3"),this.passportUrl="https://login."+(/zhubajie/.test(ZBJInfo.baseURI)?ZBJInfo.pageDomain:ZBJInfo.baseURI)}if(!$(document.body).hasClass("t5s")){var d=a("lang.product.signup").translation;a("module.verify")}return $.extend(c.prototype,{login:function(a,b){if(this.checkLogin())return a&&a(),void 0;var c={selected:"login"};this._CONF={login:{title:"登录",contentType:1,btnText:"登录"},registerPhone:{title:"手机注册",contentType:2,btnText:"注册"},registerEmail:{title:"邮箱注册",contentType:3,btnText:"注册"}},this._itemDoms={},this._options=$.extend(c,b),this._options.selected in this._CONF||(this._options=c);var d=this,e=ZDK.module.window({title:"登录",content:"<span>登录</span>",id:"loginWin"+ZDK.uuid(),width:550,mask:!0,cache:!1,zIndex:500,close:!1,hasIframe:!0,ok:"登录"});e.on("onok",function(){return!1}),e.Footer.remove(),d._panel=e,d._callback=a,d._switchTo(this._options.selected),d._bindEvents()},refreshTopbar:function(){var a=this.getUserInfoByCookie();if(this._isTopBarlogined()||!a.id)return!1;var b="http://u."+ZBJInfo.baseURI,c="http://u."+ZBJInfo.baseURI,d=this.passportUrl,e='<div class="ui-dropdown">    <span href="#none" class="ui-dropdown-hd">        <a href="'+c+'">'+a.brandName.replace(/([\S\s]{10})(.*)/,"$1...")+"<b></b></a>"+"    </span>"+'    <div class="ui-dropdown-menu nouserinfo">正在加载...</div>'+"</div>"+'<span class="split">|</span>'+'<div class="navusernews ui-dropdown">'+'        <div id="j-msg-tip" class="ui-poptipnoc ui-poptipnoc-bottom">'+'        <div class="ui-poptipnoc-arrow"><i></i></div>'+'        <div class="ui-poptipnoc-bd">你有新的消息!</div>'+"    </div>"+'    <a href="#" class="ui-dropdown-hd item-usernews">'+'        <i id="j-msg-icon" class="iconfont">&#xe81d;</i><b></b></span>'+"    </a>"+'    <ul class="unstyled fr ui-dropdown-menu item-usernews-dropdown navmsg">'+'    <li><a id="j-msg-trade" href="'+b+'/notice/list-type-1" target="_blank">查看交易提醒</a></li>'+'    <li><a id="j-msg-recommend" href="'+b+'/officialtaskinvite/snatch" target="_blank">查看派单通知</a></li>'+'    <li><a id="j-msg-system" href="'+b+'/notice/list-type-2" target="_blank">查看活动/其他通知</a></li>'+'    <li style="display:none;"><a id="j-msg-chengxin" href="'+b+'/notice/list-type-3" target="_blank">查看诚信委员通知</a></li>'+'    <li><a id="j-msg-replay" href="'+b+'/taskcomment/commentlist-state-1.html" target="_blank">查看评论</a></li>'+'    <li><a id="j-msg-logs" href="'+b+'/notice/chat" target="_blank">查看聊天记录</a></li>'+'    <li><a id="j-msg-bid" href="'+b+'/taskcomment/bids" target="_blank">查看参与</a></li>'+'    <li><a id="j-msg-thx" href="'+b+'/task/seller?s=5" target="_blank">查看谢谢</a></li>'+'    <li><a id="j-msg-fans" href="'+b+'/fav/index-type-2" target="_blank">查看粉丝</a></li>'+"    </ul>"+"</div>";this.$topBarCtn.addClass("ui-header-logined").addClass("item-userinfo").html(e);var f='欢迎来到猪八戒网<a href="'+c+'" class="user-name">'+a.brandName+"</a>"+'<a href="'+d+'/login/dologout">退出</a>';$("#J-header-logic1").html(f);var g=this;$(".item-userinfo .ui-dropdown").eq(0).one("mouseover",function(){$.ajax({url:"http://www."+ZBJInfo.baseURI+"/main/Ajaxuserinfo-uid-"+a.id,type:"post",dataType:"jsonp",jsonp:"jsonpcallback",success:function(a){$(".nouserinfo").html(a.replace(/^\s*"/,"").replace(/"\s*$/,"")).removeClass(".nouserinfo"),g.loadBalance()}})})},loadBalance:function(){var a=$("#my-balance-holder,.my-balance-holder"),b="http://task."+ZBJInfo.baseURI+"/api/MyBalance";a.length>0&&$.ajax({url:b,type:"get",dataType:"jsonp",jsonp:"jsonp",data:{pic:"1"},success:function(b){1==b.state&&(a.html(b.amount),b.amount>0&&$("#withdraw-link").show())}})},checkLogin:function(a){return ZDK.cookie.getCookie("userid")?!0:(a&&ZDK.Tips("请先登录!",3e3,"error"),!1)},getUserInfoByCookie:function(){if(!ZDK.cookie)return{};var a=ZDK.cookie.getCookie,b=a("userid"),c={id:b,brandName:a("brandname")||a("nickname"),avatar:ZDK.cookie.getUserImg(b)};return c},_bindEvents:function(){var a=this;this._panel.Body.delegate(".j_item_switch","click",function(b){b.preventDefault();var c=$(this);a._switchTo(c.attr("data-item-sele"))}).delegate(".j_verify_ctn img,.j_verify_ctn a","click",function(b){b.preventDefault(),a._refreshVerify()})},_switchTo:function(a){var b=this._CONF[a];this._panel.setTitle(b.title).setContentNode(this._initContent(a)),this._refreshVerify(),this._validate(this._panel.Body.find("form"))},_initContent:function(a){if(this._itemDoms[a])return this._itemDoms[a];var b,c=this.passportUrl,d='<iframe class="hide" id="login-submit" name="login-submit"></iframe><form target="login-submit" method="post" action="/login/dologin" id="loginForm" class="ui-window-login login-panel j_form_login"><div class="tab-t mb20"><a href="#" class="cur j_item_switch" data-item-sele="login"><i></i>登录</a><a href="#" class="j_item_switch" data-item-sele="registerPhone"><i></i>注册</a></div><div class="control-group clearfix"><label for="inputWarning" class="control-label">登录名：</label><div noblur="1" max="100" min="1" requiredtips="登录名不能为空" required="" class="controls ui-form-item" data-index="0"><input type="text" name="username" tabindex="1" id="inputWarning"><span class="help-inline lin9">可输入手机号码、邮箱和用户名</span></div></div><div class="control-group clearfix"><label for="inputWarning" class="control-label">登录密码：</label><div noblur="1" max="16" min="6" requiredtips="请填写登录密码" required="" class="controls ui-form-item"><input type="password" name="password"><span class="help-inline lin9">请填写密码</span></div></div><div class="control-group clearfix"><label for="inputWarning" class="control-label">验证码：</label><div required="" class="controls ui-form-item"><input type="text" style="width: 80px" name="catcha"></div><p class="j_verify_ctn clearfix"><input type="hidden" value="50e0ecd1e16ab" name="seed"><img id="catchaimg" src="'+c+'/login/verify?seed=50e0ecd1e16ab" class="ml5"><span class="gray6">看不清楚？<a href="javascript:void(0);">换一张</a></span></p>'+"</div>"+'<p class="xieyi clearfix">'+'<label><input type="checkbox" value="1" name="cache">'+"<span>两周内自动登录</span></label></p>"+'<p class="sub-btn mt20">	'+'<input type="hidden" value="http://www.zhubajie.com/" name="fromurl">'+'<button class="ui-btn ui-btn-inverse j_btn_submit" id="subLogin"><i></i>登录</button><a href="'+c+'/retrieve/index.html?mode=1" class="underline ml10">忘记密码？</a>'+"</p>"+'<h4 class="other-tit">使用合作账号登录</h4>'+'<ul class="win-other-login clearfix">'+'<li><a class="qq" href="'+c+'/oauth/redirect/act/QQ"></a></li>'+'<li><a class="xinL" href="'+c+'/oauth/redirect/act/sina"></a></li>'+'<li><a class="touban" href="'+c+'/oauth/redirect/act/douban"></a></li>'+'<li><a class="ren" href="'+c+'/oauth/redirect/act/renren"></a></li>'+'<li><a class="taob" href="'+c+'/oauth/redirect/act/taobao"></a></li>'+"</ul>"+"</form>",e='<div class="control-group clearfix"><label for="inputWarning" class="control-label">登录密码：</label><div max="16" min="6" required="" class="controls ui-form-item" data-index="1"><input type="password" tabindex="2" maxlength="16" name="password"><span class="help-inline lin9">6～16个数字、字母或特殊符号组成</span></div></div><div class="control-group clearfix"><label for="inputWarning" class="control-label">确认密码：</label><div max="16" min="6" required="" class="controls ui-form-item" data-index="2"><input type="password" tabindex="3" maxlength="16" name="cpassword"><span class="help-inline lin9" data-title="请输入确认密码">请输入确认密码</span></div></div><div class="control-group clearfix"><label for="inputWarning" class="control-label">昵称：</label><div max="16" min="4" ajaxurl="'+c+'/register/chkun/type-1" required="" class="controls ui-form-item" data-index="3">'+'<input type="text" maxlength="16" tabindex="4" name="account">'+'<span class="help-inline lin9" data-title="4~16个字符，汉字长度为2个字符">4~16个字符，汉字长度为2个字符</span>'+"</div>"+"</div>"+'<div class="control-group clearfix">'+'<label for="inputWarning" class="control-label">验证码：</label>'+'<div required="" class="controls ui-form-item" data-index="4">'+'<input type="text" tabindex="5" style="width: 80px" name="catcha">'+"</div>"+'<p class="j_verify_ctn clearfix"><input type="hidden" value="50e0ecd1e16ab" name="seed">'+'<img id="catchaimg" src="'+c+'/login/verify?seed=50e0ecd1e16ab" class="ml5">'+'<span class="gray6">看不清楚？<a href="javascript:void(0);">换一张</a></span></p>'+"</div>"+'<p id="xy" requiredtips="请先阅读猪八戒协议" required="" class="xieyi clearfix ui-form-item" data-index="5">'+'<label><input type="checkbox" checked="checked" tabindex="6"> '+'<span>我已阅读并接受</span></label><span><a href="http://zt.zhubajie.com/ztold/dealzbj/" target="_blank">《猪八戒网服务协议》</a></span></p>'+'<p class="sub-btn"><button class="ui-btn ui-btn-inverse j_btn_submit"><i></i>注册</button></p>'+"</form>",f='<iframe style="display:none;" id="register-submit" name="register-submit"></iframe><form target="register-submit" action="'+c+'/register/doreg" method="post" id="signup" class="register login-panel j_form_signup">'+'<input type="hidden" name="type" value="1" />'+'<div class="tab-t mb20">'+'<a href="#" class="j_item_switch" data-item-sele="login"><i></i>登录</a>'+'<a href="#" class="cur title-link j_item_switch" data-item-sele="registerPhone"><i></i>手机注册</a>'+'<a href="'+c+'/register/" class="email-link j_item_switch" data-item-sele="registerEmail" target="_blank"><i></i>邮箱注册</a></div>'+'<div class="control-group clearfix">'+'<label for="inputWarning" class="control-label">手机号码：</label>'+'<div type="tel" required="" ajaxurl="'+c+'/register/chkun/type-2?jsonpcallback=?" class="controls ui-form-item" data-index="0">'+'<input type="text" tabindex="1" name="mobile">'+'<span class="help-inline lin9" data-title="用以在多个终端登录和找回密码">用以在多个终端登录和找回密码</span>'+"</div>"+"</div>",g='<iframe style="display:none;" id="register-submit" name="register-submit"></iframe><form target="register-submit" action="'+c+'/register/doreg/type-1" method="post" id="signup" class="register login-panel j_form_signup">'+'<input type="hidden" name="pop" value="true" /><input type="hidden" name="type" value="2" />'+'<div class="tab-t mb20">'+'<a href="#" class="j_item_switch" data-item-sele="login"><i></i>登录</a>'+'<a href="#" class="cur title-link j_item_switch" data-item-sele="registerEmail"><i></i>邮箱注册</a>'+'<a href="#" class="email-link j_item_switch" data-item-sele="registerPhone"><i></i>手机注册</a></div>'+'<div class="control-group clearfix">'+'<label for="inputWarning" class="control-label">邮箱地址：</label>'+'<div type="email" required="" ajaxurl="'+c+'/register/chkun/type-3?jsonpcallback=?" class="controls ui-form-item" data-index="0">'+'<input type="text" tabindex="1" name="email" id="email" autocomplete="off">'+'<span class="help-inline lin9" data-title="用以在多个终端登录和找回密码">用以在多个终端登录和找回密码</span>'+"</div>"+"</div>";switch(a){case"registerPhone":case"registerEmail":b=$(("registerPhone"===a?f:g)+e);break;default:b=$(d)}return this._itemDoms[a]=b,b},_submitLogin:function(){function a(a){return 1!=a.state?-2==a.state?document.location.href=a.url:(ZDK.Tips(a.msg,2e3,"error"),e._refreshVerify()):(e._panel.hide(),e.refreshTopbar(),e._callback?e._callback(a,e._panel):ZDK.Tips("登录成功！",3e3,"success")),!1}var b=this._panel.Body,c=b.find(".j_form_login");if(c.data("loading")!==!0){c.data("loading",!0);var d=this.passportUrl,e=this;$.ajax({type:"post",url:d+"/login/dologin",data:c.serialize(),dataType:"jsonp",jsonp:"jsonpcallback",success:function(b){a(b),c.data("loading",!1)}})}},_submitRegister:function(){function a(a){function d(a){var b=60,c=a.attr("ajaxurl"),d=setInterval(function(){a.html("(<font class='orange'>"+b+"</font>)秒后重新获取").attr("ajaxurl","javascript:void(0)").css({color:"#999"}),b--,0>=b&&(clearInterval(d),a.html("重新发送").attr("ajaxurl",c).css({color:"#0B73BB"}))},1e3)}return 1!=a.state?(a.type?ZDK.module.poptip({target:c.find("input").eq(parseInt(a.type)),theme:"ui-verify-tips",content:'<p class="ui-warning-min">'+a.msg+"</p>",width:16*a.msg.length+45,cache:!1,zIndex:501}):ZDK.Tips(a.msg,3e3,"error"),b._refreshVerify()):(b._panel.resetBody(b._getPhoneValidHtml(3)),c.find("input[name='kid']").val(a.kid),c.find("#phone-num").html(a.mobile),c.find("#rePot").attr("key",a.key),c.find("#save").click(function(){return $.ajax({url:c.find("#signup").attr("action"),data:c.find("#signup").serialize()+"&jsonpcallback=?",dataType:"jsonp",jsonp:"jsonpcallback",success:function(a){1==a.state?b._callback?b._callback(a,b._panel):ZDK.Tips("注册成功！",3e3,"success"):ZDK.Tips(a.msg,3e3,"warning")}}),!1}),c.find("#rePot").click(function(){var b=$(this),e=c.find("input[name='kid']").val();return"javascript:void(0)"!=b.attr("ajaxurl")&&$.ajax({type:"post",url:b.attr("ajaxurl"),data:"key="+b.attr("key")+"&kid="+e+"&jsonpcallback=?",dataType:"jsonp",jsonp:"jsonpcallback",success:function(a){1==a.state?d(b):1==a.limit?(b.attr("ajaxurl","javascript:void(0)").html(a.msg).css({color:"#999"}),ZDK.Tips(a.msg,3e3,"warning")):ZDK.Tips(a.msg,3e3,"warning")},error:function(){ZDK.Tips(a.msg,3e3,"warning")}}),!1})),!1}var b=this,c=b._panel.Body,d=c.find(".j_form_signup");if(d.data("loading")!==!0){d.data("loading",!0),"regcallback"+ +new Date;var e=d.attr("action");-1!=e.indexOf("?jsonpcallback")&&(e=e.substr(0,e.indexOf("?jsonpcallback"))),d.attr("action",e),$.ajax({type:"post",url:e,data:d.serialize(),dataType:"jsonp",jsonp:"jsonpcallback",success:function(b){a(b),d.data("loading",!1)}})}},_validate:function(a){var b=this,c=ZDK.module.verify({target:a,button:a.find(".j_btn_submit"),errorClass:"error",successClass:"success",warningClass:"warning",asynClass:"loading",holderLeft:10,holderTop:10});c.on("itemfocus",function(a){var b=a.item.find(".help-inline");b.show()}).on("checkerror",function(a){var b=a.item.find(".help-inline");b.attr("data-title")||b.attr("data-title",b.html()),b.html(a.res)}).on("checksuccess",function(b){if(!a.hasClass("j_form_login")){var d=0^b.item.attr("data-index");if(3==d){var e=c.items.eq(3),f=e.find("input"),g=f.val();if(/^[0-9]/.test(g))return c.changeState(f,e,"error"),b.item.find(".help-inline").html("昵称不能以数字开头！"),!1}else if(2==d){var h=b.item.parent(".control-group").prev(".control-group");if(b.input.val()!=h.find("input[type='password']").val())return c.changeState(b.input,b.item,"error"),b.item.find(".help-inline").html("两次密码必须一致！"),!1}else if(1==d){var e=c.items.eq(2),f=e.find("input");f.val()&&(f.val()!==b.input.val()?(c.changeState(f,e,"error")(f,e,"success",!0,c),e.find(".help-inline").html("两次密码必须一致！")):(e.find(".help-inline").html("确认登录密码"),c.changeState(f,e,"sucess")(f,e,"error",!0,c)))}if(1!==d){var i=b.item.find(".help-inline");i.html("")}}}).on("asyning",function(a){var b=0^a.item.attr("data-index");(0==b||2==b)&&a.item.find(".help-inline").html(d("checkloading"))}).on("asynError",function(a){var b=0^a.item.attr("data-index");(0==b||3==b)&&a.item.find(".help-inline").html(a.json.msg)}).on("asynSuccess",function(a){var b=0^a.item.attr("data-index");(0==b||3==b)&&a.item.find(".help-inline").html("")}).on("submitBefore",function(){return a.hasClass("j_form_login")?b._submitLogin():b._submitRegister(),!1})},_refreshVerify:function(){var a=this._panel.Body.find(".j_verify_ctn"),b=a.find("img"),c=a.find("input[type=hidden]"),d=b.attr("src"),e=+new Date;d=(d+"").replace(/seed=(\w+)/,function(){return"seed="+e}),b.attr("src",d),a.find("input").not("[type=hidden]").val(""),c.val(e)},_getPhoneValidHtml:function(){var a=this.passportUrl;return'<div class="bcf-brc win-th-phone"><h3 class="tit">马上验证手机，激活你的账号！</h3><p class="status mt10">验证码已通过短信发送至<font color="#ff6600" id="phone-num">135******58</font>，请输入完成验证</p><p class="alt">手机绑定是为保障用户的信息真实性和帐号安全性</p><div class="control-group clearfix"><form method="post" action="'+a+'/register/verify" id="signup">'+'<div max="16" min="6" placeholder="请输入验证码" required="" class="controls ui-form-item" data-index="0">'+'<input type="text" name="ticket" tabindex="1" placeholder="请输入验证码"></div>'+'<a id="save" href="javascript:void(0);" class="butn max-butn max-butn-green"><i></i>验证</a>'+'<input type="hidden" name="kid">'+"</form></div>"+'<p class="resh-time">若长时间未收到，请点此<a href="javascript:void(0);" ajaxurl="'+a+'/register/resend" class="ml10" id="rePot">重新发送</a></p></div>'},_isTopBarlogined:function(){return!!$(".ui-header-logined").length}}),ZDK.passport=new c,ZDK.passport.refreshTopbar(),b.passport=c,ZDK.procopy(c,ZDK.EventEmitter)}),function(){var a=$(".category-status-close .category-content");a.show(),$(".category-item-two").each(function(){var a=$(this),b=a.height(),c=a.closest(".category-item"),d=c.height(),e=c.position().top;b>e+d?0==e?a.css("top",-e-1):a.css("top",-e+1):b>e/2&&a.css("top",-b/2)}),a.attr("style","");var b,c;$(".category").delegate(".category-item","mouseover",function(){var a=$(this);clearTimeout(b),b=setTimeout(function(){$(".category-content").find(".hover").removeClass("hover"),a.addClass("hover")},150)}),$(".category").delegate(".category-content","mouseleave",function(){var a=$(this);clearTimeout(b),setTimeout(function(){a.find(".hover").removeClass("hover")},200)}),$(".category-status-close").bind("mouseover",function(){var a=$(this);c=setTimeout(function(){a.find(".category-content").show()},300)}),$(".category-status-close").bind("mouseleave",function(){var a=$(this);clearTimeout(c),setTimeout(function(){a.find(".category-content").hide()},300)}),$(".hall-nav").length>0&&$("#j-zbj-header ,.hall-nav,.ui-logo-sub").css("background-color","#f6f6f6")}(),function(){var a="http://u."+ZBJInfo.baseURI+"/notice/getcount?jsonpcallback=?",b={requestTime:200,intervalTime:18e5,init:function(){return/https/.test(window.location.href)?!1:(ZDK.cookie.getCookie("userid")&&(this.start(),this.bindEvent()),void 0)},start:function(){var a=this;setTimeout(function(){a.sendRequest()},a.requestTime)},sendRequest:function(){var b=this;$.getJSON(a,function(a){a&&b.updateMsgIndicator(a)})},updateMsgIndicator:function(a){var b=0;for(var c in a)if(a.hasOwnProperty(c)){var d=1*a[c],e=$("#j-msg-"+c);d>0&&(b+=d),d>0?(e.find(".highlight").remove(),e.prepend(' <span class="highlight">'+d+"</span>"),"chengxin"==c&&e.parent("li").show()):(e.find("span").remove(),"chengxin"==c&&e.parent("li").hide())}this.setBlinkIcon(b>0),this.requestTime=this.intervalTime,this.start()},setBlinkIcon:function(a){if(a){if(!this._blinkTimer){this._blinkTimer=setInterval(function(){$("#j-msg-icon").css("visibility","hidden"),setTimeout(function(){$("#j-msg-icon").css("visibility","visible")},400)},1e3),$("#j-msg-tip").show();var b=this;$(".navusernews").one("mouseover",function(){$("#j-msg-tip").hide(),b.setBlinkIcon(!1)})}}else this._blinkTimer&&(clearInterval(this._blinkTimer),$("#j-msg-icon").css("visibility","visible"),this._blinkTimer=null)},bindEvent:function(){var a=this;$("ul.item-usernews-dropdown a").click(function(){a.onmsgItemClick($(this))})},onmsgItemClick:function(a){var b=a.find("span");if(b.size()){var c=parseInt($("#j-msg-total").html(),10)-parseInt(b.html().replace(/\s/g,""),10);c>0?$("#j-msg-total").html(c).show():$("#j-msg-total").hide(),b.remove()}},makeTips:function(){}};b.init(),/login.v5.zbj.com/.test(window.location.href)||/login.zhubajie.com/.test(window.location.href)||window.WebIM&&WebIM.onNotification&&WebIM.onNotification(function(a){var c=a.content.msgcount;b.updateMsgIndicator(c)})}(),function(){function a(){var a={title:"在线咨询",link:"http://livechat.zhubajie.com/LR/Chatpre.aspx?id=PCF83427900&skid=27",className:""};window.ZBJInfo&&window.ZBJInfo.chatCfg&&$.extend(a,window.ZBJInfo.chatCfg);var b='<div class="ui-tools-top ui-tools-livechat"><a class="{%className%}" href="{%link%}" target="_blank" title="{%className%}"><i class="ui-ico ui-ico-cs"></i></a></div>';return b=f(b,a),$(b).appendTo(document.body)}function b(){var a={title:"意见反馈",link:"http://task.zhubajie.com/3105598/",className:""};window.ZBJInfo&&window.ZBJInfo.feedbackCfg&&$.extend(a,window.ZBJInfo.feedbackCfg);var b='<a href="{%link%}" target="_blank" class="item-tools {%className%}" id="j-feedback-btn"><span class="item-ico"><i class="ui-ico ui-ico-feed"></i></span><span class="item-txt">{%title%}</span></a>';return b=f(b,a)}function c(a,b){$.ajax({url:safepwdUrl,data:"tips=1",dataType:"jsonp",jsonp:"jsonpcallback",success:function(c){var e;-2==c.state?(e="输入你的安全密码",i.removeAttr("id").addClass("safepwdUrl"),i.find(".control-group").html('<label style="width:110px" for="inputWarning" class="control-label">输入你的安全密码</label><div class="controls"><em>输入你的安全密码</em><p><input type="password" id="inputWarning"><a target="_blank" href="http://help./main/findspas" class="ml10 underline">忘记密码？</a></p></div>'),d(a,b),i.find(".controls").inputEmpty(e)):(e="请输入手机号码",d(a,b))}})}function d(a,b){var c=b&&b.btn_cancel,d=ZDK.module.window({title:"账户安全提醒",content:i.show(),width:485,mask:!0,cache:!1,zIndex:500,allowClose:!0,hasIframe:!0,ok:"下一步",cancel:c||"跳过，下次再说"});return b&&(b.alert&&i.find(".alert-img").html("<em></em>"+b.alert),b.title&&d.resetTitle(b.title)),i.find(".controls").inputEmpty("请输入手机号码"),d.Close.click(function(){a&&a()}),d.Body.find("form").submit(function(){return d.Footer.find(".ui-window-ok").click(),!1}),d.on("onok",function(){return $("#cert-phone").length?e(d):$(".safepwdUrl").length?$.ajax({url:safepwdUrl,data:"s_pas="+$(".safepwdUrl").find("input[type='password']").val()+"&act=1",dataType:"jsonp",jsonp:"jsonpcallback",success:function(a){1==a.state?(i.attr("id","cert-phone").removeClass("safepwdUrl"),i.find(".control-group").html('<label class="control-label" for="inputWarning" style="width:110px">输入你的手机号码</label><div class="controls"><em>请输入手机号码</em><p><input type="text" id="inputWarning"><span class="help-inline">暂只支持中国地区手机号码</span></p></div>'),i.find(".alert").hide(),d.resetBody(i.show()),i.find(".controls").inputEmpty("请输入手机号码")):ZDK.Tips(a.msg,2e3,"error")}}):$.ajax({url:m,data:"vid="+j.find("input[name=vid]").val()+"&code="+j.find("input[name=code]").val(),dataType:"jsonp",jsonp:"jsonpcallback",success:function(b){if(1==b.state){if(ZDK.Tips("您的手机已绑定成功！",2e3,"success"),d.hide(),a)return a(),!1;/payorder|task/.test(location.href)&&setTimeout(function(){location.reload()},2e3)}else ZDK.Tips(b.msg,2e3,"error")}}),!1}),d.on("oncancel",function(){function b(){var a=new Date,b=a.getDate();return a.setDate(b+1),a}var c,d;/u.zhubajie.com/.test(location.href)?(c="http://u."+ZBJInfo.baseURI+"/main/disablepop",d="get"):(c="http://u."+ZBJInfo.baseURI+"/main/disablepop?jsonpcallback=?",d="jsonp"),$.ajax({type:d,url:c,dataType:"json",complete:function(){}}),o("needmobile",0,b()),a&&a()}),d}function e(a){var b=$("#cert-phone").find("input[type='text']").val();$.ajax({url:k,data:"mobile="+b+"&tips=1",dataType:"jsonp",jsonp:"jsonpcallback",success:function(c){function d(a){a.attr("disabled","disabled");var b=60;a.html("<i></i>重发验证码(60)").removeClass("butn-green");var c=setInterval(function(){b-->0?a.html("<i></i>发送验证码("+b+")"):(clearInterval(c),a.removeAttr("disabled").html("<i></i>重发验证码").addClass("butn-green"))},1e3)}if(1==c.state){j.find(".phone-number").html(b),j.find("input[name='vid']").val(c.vid),a.resetOkButton("提交并完成绑定"),a.resetBody(j),j.find(".controls").inputEmpty("请输入短信验证码"),j.find("#resendcode").click(function(){var a=$(this);return"disabled"==a.attr("disabled")?!1:($.ajax({url:l,data:"vid="+$("#phone-verify").find("input[name='vid']").val(),dataType:"jsonp",jsonp:"jsonpcallback",success:function(b){1==b.state?(d(a),ZDK.Tips(b.msg,2e3,"success")):ZDK.Tips(b.msg,2e3,"error")}}),void 0)}),d(j.find("#resendcode"));var e=j.find(".phone-number");e.next("a").click(function(){return i.find(".name,.alert").remove(),i.find(".control-label").html("请重新输入手机号码"),a.resetBody(i.show()),a.resetOkButton("下一步"),!1})}else ZDK.Tips(c.msg,2e3,"error")}})}if(!(document.location.href.indexOf("https://")>=0)){var f=function(a,b){return a.replace(/{%([^%]*)%}/g,function(a,c){return b[c]})},g='<div class="ui-tools-bottom"><div class="ui-tools-gotop"><a class="item-tools" href="javascript:;" title="返回顶部" id="j-goTop"><i class="iconfont">&#xe806;</i></a><i class="ui-ico ui-ico-toppig"></i></div><div class="ui-tools-app"><a class="item-tools" href="http://m.zhubajie.com" target="_blank"><span class="item-ico"><i class="ui-ico ui-ico-mobile"></i></span><span class="item-txt">移动应用</span><div class="ui-poptipnoc ui-poptipnoc-left"><div class="ui-poptipnoc-arrow"><i></i></div><div class="ui-poptipnoc-bd"><div><div class="item-weixin"></div><p>官方微信<br/>轻松找人做事</p></div><div class="ui-vline"></div><div><div class="item-mobile"></div><p style="line-height: 32px;">手机下单，送红包</p></div></div></div></a></div><div class="ui-tools-feed">'+b()+"</div>"+"</div>";if($(function(){function b(){return $(window).scrollTop()}function c(a){$(window).scrollTop(~~a)}var d=$("body");window.ZBJInfo&&window.ZBJInfo.isShowChatEntry&&a();var e=$(g).appendTo(d);window.fix_poptip_on_t5&&fix_poptip_on_t5(e);var f=e.find(".ui-tools-gotop").hide(),h=f.find(".ui-ico-toppig").hide(),i=f.find(".item-tools");$(window).scroll(function(){b()>0?f.show():f.hide()}),e.delegate(".ui-tools-gotop","click",function(){function a(){c(b()/1.1),b()<1&&(clearInterval(d),h.hide(),i.show())}i.hide(),h.show();var d=setInterval(a,5)})}),!window.mobileVerify){var h="http://u.zhubajie.com/pay/withdraw"==location.href?"您尚未绑定手机，提现操作可能存在一定风险，我们建议您立即绑定手机。":"你的账户中有余额，为了保障你的资金安全，建议你立即绑定手机。",i=$('<form id="cert-phone"><div class="gray9 mt10 alert"><div class="alert-img"><em></em>'+h+"</div></div>"+'<div class="control-group clearfix mt15">'+'<label class="control-label" for="inputWarning" style="width:110px">输入你的手机号码</label>'+'<div class="controls">'+"<em>请输入手机号码</em>"+"<p>"+'<input type="text" id="inputWarning">'+'<span class="help-inline">暂只支持中国地区手机号码</span>'+"</p>"+"</div>"+"</div>"+"</form>"),j=$('<style>.ui-verify-tips .ui-poptip-arrow{left:30px}</style><form id="phone-verify"><div class="alert"><div class="alert-img"><em></em>已发送短信验证码至<strong class="orange phone-number">136 **** 9856</strong><a href="" class="ml10 underline" style="color:#999">错误的手机号？</a></div></div><div class="control-group clearfix mt15"><label class="control-label" style="width:110px;padding-top:6px">请输入短信验证码</label><div class="controls"><em style="top:5px">请输入短信验证码</em><input type="text" style="padding:5px" name="code"><a class="butn ml10 butn-green" href="###" id="resendcode"><i></i>重发验证码</a> </div></div><input type="hidden" name="vid" /></form>'),k="http://u."+ZBJInfo.baseURI+"/cert/sendcode",l="http://u."+ZBJInfo.baseURI+"/cert/resendcode",m="http://u."+ZBJInfo.baseURI+"/cert/vmobile";safepwdUrl="http://u."+ZBJInfo.baseURI+"/cert/checksafepass","login."+ZBJInfo.baseURI+"/register/complete","login."+ZBJInfo.baseURI+"/register/tag","login."+ZBJInfo.baseURI+"/register/people";var n=ZDK.cookie&&ZDK.cookie.getCookie?ZDK.cookie.getCookie:GetCookie,o=ZDK.cookie&&ZDK.cookie.setCookie?ZDK.cookie.setCookie:SetCookie;(1==n("needmobile")&&0==/cert\/mobile/.test(location.href)||1==/pay\/withdraw/.test(location.href)&&n("mobilepoped"))&&0==$("#noMobileTip").size()&&c(),window.mobileVerify=c}}}(),function(){function a(){return $("#j-pub-entry").size()}function b(){$(window).scroll(function(){var a=parseFloat($(window).scrollTop()),b=parseFloat($(window).height()),c=$(".ui-no-appropriate"),d=$("#j-pub-entry");if(c.length>0){var e=c.offset().top+c.outerHeight(),f=b+a;a>0&&e>f?d.show():d.hide()}else a>10?d.show():d.hide()})}a()&&b()}(),function(){function a(){function a(a){a=parseInt(a),a>0&&(c.html(a),c.show(),c.attr("tool-map","top"),c.attr("tool-text","你有"+a+"个官方派单待处理"),c.addClass("zbj-tooltip"),$("#j-my-invitetask-digit").html(a),$(".ui-header-nav .ui-dropdown:contains(服务商中心)").after($("<a></a>").attr({href:"http://u."+ZBJInfo.baseURI+"/officialtaskinvite/snatch",target:"_blank"}).append(c.clone().attr({id:"","tool-map":"bottom","tool-cls":"snatch-topnar-tip"}).css("position","static"))))}function b(){return"http://u."+ZBJInfo.baseURI+"/officialtaskinvite/count"}var c=$("#j-invitetask-dom-tips-num");0==c.size()&&(c=$('<span class="menu-tips-num" id="j-invitetask-dom-tips-num"></span>')),$.getJSON(b()+"?jsonpcallback=?",function(b){1==b.state&&a(b.msg.todo)})}window.GetCookie||(window.GetCookie=ZDK.cookie.getCookie),GetCookie("userid")&&a(),$("#j-header-searchwrap li").click(function(){var a,b="http://search."+ZBJInfo.baseURI,c=$(this),d=c.data("type");"witkey"==d?a=0:"task"==d?a=1:"service"==d&&(a=2),$("#j-header-searchlabel").text(c.find("a").text()),c.hide().siblings().show(),c.parent().hide(),$("#j-header-kw").focus();var e=$("#j-header-searchform")[0];0==a?e.action=b+"/p/":1==a?e.action=b+"/t/":2==a&&(e.action=b+"/s/")}),$("#j-header-searchwrap").hover(function(){$(this).find(".ui-dropdown-menu").show()},function(){$(this).find(".ui-dropdown-menu").hide()})}(),function(){$("#skinset").live("click",function(){$.ajax({url:"http://home.zhubajie.com/skin/index?jsonpcallback=?",type:"get",dataType:"json",success:function(a){if(1==a.state){var b=ZDK.module.window({title:"模板设置",content:a.msg,cache:!1,width:450,ok:"保存",cancel:"关闭"});b.on("onok",function(){return b.Footer.find(".ui-window-ok").html("<i></i>请求中...").removeClass("small-butn-orange"),$.ajax({url:"http://home.zhubajie.com/skin/index?jsonpcallback=?",type:"post",data:"type=1&showway="+$("#ck-style .cur").attr("flag"),dataType:"json",success:function(a){b.Footer.find(".ui-window-ok").html("<i></i>确认").addClass("small-butn-orange"),1==a.state?(ZDK.Tips("设置成功！",3e3,"success"),a.url&&(location.href=a.url),b.hide()):ZDK.Tips(a.msg,3e3,"error")}}),!1})}}})})}(),$(function(){function a(){$.ajax({url:c,type:"get",dataType:"jsonp",jsonp:"jsonp",data:{pic:"1"},success:function(a){1==a.state&&(b.html(a.amount),a.amount>0&&$("#withdraw-link,.withdraw-link").show())}})}var b=$("#my-balance-holder,.my-balance-holder"),c="http://task."+ZBJInfo.baseURI+"/api/MyBalance";b.length>0&&(location.host=="u."+ZBJInfo.baseURI?a():$(".item-userinfo .ui-dropdown").one("mouseover",function(){a()}))}),function(){document.location.href.indexOf("https://")>=0||document.cookie.indexOf("zbj_advert_zh")<0&&$.getScript("http://intstyle.zhubajie.com/js/int.advert.min.js?v=20131231")}(),function(){function a(a){return a.indexOf("u."+window.ZBJInfo.baseURI)>0}function b(b){var d=c(b.target),e=d.href,f=+new Date;a(e)&&!/_t=\d+/.test(e)&&(e+=(e.indexOf("?")<0?"?":"&")+"_t="+f,d.href=e)}function c(a){for(;a;){if("A"==a.nodeName)return a;a=a.parentNode}return null}$("div.ui-header").delegate("div.ui-dropdown a","mouseover",function(a){b(a)}),$("div.ui-header").delegate("div.lot a","mouseover",function(a){b(a)}),$("#J-header-logic1").delegate("a","mouseover",function(a){b(a)}),a(document.location.href)&&$(document.body).delegate("a","mouseover",function(a){b(a)})}(),function(){function a(){1!==c&&(c=1,b())}function b(){$.getScript(ZBJInfo.staticURI+"/mirror/static/feedback.js",function(){c=4,$(document.body).undelegate("#j-feedback-btn","mouseenter",a),$.feedback({proxy:"http://slogger.zhubajie.com/html2canvasproxy.php",html2canvasURL:ZBJInfo.staticURI+"/mirror/static/html2canvas.js",feedbackBtnSelector:"#j-feedback-btn"})})}var c=0;$(document.body).delegate("#j-feedback-btn","mouseenter",a)}(),function(){if("zhubajie.com"!=ZBJInfo.baseURI){var a=$("#j-zbj-header").find('a[data-process="1"], form[data-process="1"], area[data-process="1"]');a.each(function(a,b){var c="FORM"==b.nodeName?"action":"href",d=b[c];b[c]=d.replace("zhubajie.com",ZBJInfo.baseURI)})}var b=$("#j-head-pubentry"),c=$("#j_current_category");if(c.size()&&c.size()){var d=b.attr("href");b.attr("href",d.replace("step1","step1-category-"+c.val()))}var e={witkey:"服务商",task:"需&nbsp;&nbsp;&nbsp;求",service:"服&nbsp;&nbsp;&nbsp;务"},f={witkey:"/p/",task:"/t/",service:"/s/"},g=ZBJInfo.searchType;if(g){var h=$("#j-header-searchform").attr("action");$("#j-header-kw").val(ZBJInfo.kw),$("#j-header-searchlabel").html(e[g]),$("#j-header-searchform").attr("action",h.replace("/p/",f[g])),$("#j-header-searchwrap li").each(function(){$(this).data("type")==g?$(this).hide():$(this).show()})}}(),function(){ZDK.cookie.getCookie("tmpmobileentry")||$("#j-tmp-mobile-entry").css("visibility","visible");var a=function(){var a=new Date,b=a.getDate();return a.setDate(b+360),a
};$("#j-mobile-entry-close").click(function(){ZDK.cookie.setCookie("tmpmobileentry",1,a(),"/",ZBJInfo.pageDomain),$("#j-tmp-mobile-entry").css("visibility","hidden")})}(),$(document).ready(function(){function a(a){var d=a.attr("data-cmstoken");d&&(b[d]||(b[d]=!0,$.ajax({url:"http://cms.zbjimg.com/cmsfiles/"+d+".js",jsonpCallback:"_"+d.replace(/.*\//,"")+"_js",dataType:"jsonp",success:function(a){var b=a.content.split("##split##");c.filter('[data-cmstoken="'+d+'"]').each(function(){var a=$(this),c=a.attr("data-cmsindex")||0;a.html(b[c]||"")})}})))}var b={},c=$(".j_cms_ctn");c.each(function(b,c){var d=$(c);a(d)})});